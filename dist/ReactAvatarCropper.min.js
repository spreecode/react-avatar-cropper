!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("semantic-ui-react"),require("react-dom"),require("react")):"function"==typeof define&&define.amd?define(["semantic-ui-react","react-dom","react"],t):"object"==typeof exports?exports.ReactAvatarCropper=t(require("semantic-ui-react"),require("react-dom"),require("react")):e.ReactAvatarCropper=t(e["semantic-ui-react"],e["react-dom"],e.react)}(window,function(e,t,n){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";function r(e){return!!e.match(r.regex)}Object.defineProperty(t,"__esModule",{value:!0}),t.isDataURL=r,r.regex=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i},function(t,n){t.exports=e},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";var r=n(3);function o(){}e.exports=function(){function e(e,t,n,o,i,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=o,n.PropTypes=n,n}},function(e,t,n){e.exports=n(4)()},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){var n={},r=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},o=r(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),i=r(function(){return document.head||document.getElementsByTagName("head")[0]}),a=null,s=0;function u(e,t){for(var r=0;r<e.length;r++){var o=e[r],i=n[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(h(o.parts[a],t))}else{var s=[];for(a=0;a<o.parts.length;a++)s.push(h(o.parts[a],t));n[o.id]={id:o.id,refs:1,parts:s}}}}function p(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[i]?n[i].parts.push(a):t.push(n[i]={id:i,parts:[a]})}return t}function d(){var e=document.createElement("style"),t=i();return e.type="text/css",t.appendChild(e),e}function h(e,t){var n,r,o;if(t.singleton){var u=s++;n=a||(a=d()),r=l.bind(null,n,u,!1),o=l.bind(null,n,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(){var e=document.createElement("link"),t=i();return e.rel="stylesheet",t.appendChild(e),e}(),r=function(e,t){var n=t.css,r=(t.media,t.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}.bind(null,n),o=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=d(),r=function(e,t){var n=t.css,r=t.media;t.sourceMap;r&&e.setAttribute("media",r);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),o=function(){n.parentNode.removeChild(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");void 0===(t=t||{}).singleton&&(t.singleton=o());var r=p(e);return u(r,t),function(e){for(var o=[],i=0;i<r.length;i++){var a=r[i];(s=n[a.id]).refs--,o.push(s)}e&&u(p(e),t);for(i=0;i<o.length;i++){var s;if(0===(s=o[i]).refs){for(var d=0;d<s.parts.length;d++)s.parts[d]();delete n[s.id]}}}};var c=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function l(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=c(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){(e.exports=n(9)()).push([e.i,".AvatarCropper-base {\n  text-align: center;\n}\n\n.AvatarCropper-base input[type=range] {\n  display: inline-block;\n}\n\n.AvatarCropper-base input[type=range] {\n  /*removes default webkit styles*/\n  -webkit-appearance: none;\n  /*fix for FF unable to apply focus style bug */\n  padding: 20px 0;\n  border: 1px solid white;\n\n  /*required for proper track sizing in FF*/\n  width: 400px;\n}\n.AvatarCropper-base input[type=range]::-webkit-slider-runnable-track {\n  width: 400px;\n  height: 5px;\n  background: #ddd;\n  border: none;\n  border-radius: 3px;\n}\n.AvatarCropper-base input[type=range]::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  border: none;\n  height: 16px;\n  width: 16px;\n  border-radius: 50%;\n  background: #454545;\n  margin-top: -4px;\n}\n.AvatarCropper-base input[type=range]:focus {\n  outline: none;\n}\n.AvatarCropper-base input[type=range]:focus::-webkit-slider-runnable-track {\n  background: #ccc;\n}\n\n.AvatarCropper-base input[type=range]::-moz-range-track {\n  width: 400px;\n  height: 5px;\n  background: #ddd;\n  border: none;\n  border-radius: 3px;\n}\n.AvatarCropper-base input[type=range]::-moz-range-thumb {\n  border: none;\n  height: 16px;\n  width: 16px;\n  border-radius: 50%;\n  background: #454545;\n}\n\n/*hide the outline behind the border*/\n.AvatarCropper-base input[type=range]:-moz-focusring{\n  outline: 1px solid white;\n  outline-offset: -1px;\n}\n\n.AvatarCropper-base input[type=range]::-ms-track {\n  width: 400px;\n  height: 5px;\n\n  /*remove bg colour from the track, we'll use ms-fill-lower and ms-fill-upper instead */\n  background: transparent;\n\n  /*leave room for the larger thumb to overflow with a transparent border */\n  border-color: transparent;\n  border-width: 6px 0;\n\n  /*remove default tick marks*/\n  color: transparent;\n}\n.AvatarCropper-base input[type=range]::-ms-fill-lower {\n  background: #777;\n  border-radius: 10px;\n}\n.AvatarCropper-base input[type=range]::-ms-fill-upper {\n  background: #ddd;\n  border-radius: 10px;\n}\n.AvatarCropper-base input[type=range]::-ms-thumb {\n  border: none;\n  height: 16px;\n  width: 16px;\n  border-radius: 50%;\n  background: #454545;\n}\n.AvatarCropper-base input[type=range]:focus::-ms-fill-lower {\n  background: #888;\n}\n.AvatarCropper-base input[type=range]:focus::-ms-fill-upper {\n  background: #ccc;\n}\n.AvatarCropper-base canvas {\n  cursor: move;\n}\n\n.AvatarCropper-canvas {\n  padding: 30px 0;\n}\n",""])},function(e,t,n){var r=n(10);"string"==typeof r&&(r=[[e.i,r,""]]);n(8)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();n(11);var i=n(7),a=c(i),s=c(n(6)),u=c(n(5)),p=n(2),d=n(1),h=c(n(0));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e,t,n){(0,h.default)(!isNaN(parseInt(e[t])),"Invalid "+t+" '"+e.size+"' sent to '"+n+"'. Requires an\n    int or string capable of conversion to an int.\n    Check the render method of == '"+n+"'. == ")},g=function(e){function t(){l(this,t);var e=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={dragging:!1,image:{},mouse:{x:null,y:null},preview:null,zoom:1},e.listeners=[],e}return m(t,i.Component),o(t,[{key:"fitImageToCanvas",value:function(e,t){var n,r;this.props.height/this.props.width>t/e?r=e*((n=this.props.height)/t):n=t*((r=this.props.width)/e);return{width:r,height:n}}},{key:"prepareImage",value:function(e){var t=this,n=new Image;(0,d.isDataURL)(e)||(n.crossOrigin="anonymous"),n.onload=function(){var e=t.fitImageToCanvas(n.width,n.height);e.resource=n,e.x=0,e.y=0,t.setState({dragging:!1,image:e,preview:t.toDataURL()})},n.src=e}},{key:"mouseDownListener",value:function(e){this.setState({image:this.state.image,dragging:!0,mouse:{x:null,y:null}})}},{key:"preventSelection",value:function(e){if(this.state.dragging)return e.preventDefault(),!1}},{key:"mouseUpListener",value:function(e){this.setState({dragging:!1,preview:this.toDataURL()})}},{key:"mouseMoveListener",value:function(e){if(this.state.dragging){var t=e.clientX||e.touches[0].clientX,n=e.clientY||e.touches[0].clientY,r=this.state.image.x,o=this.state.image.y,i=this.state.image;if(this.state.mouse.x&&this.state.mouse.y){var a=this.state.mouse.x-t,s=this.state.mouse.y-n,u=this.boundedCoords(r,o,a,s);i.x=u.x,i.y=u.y}this.setState({image:this.state.image,mouse:{x:t,y:n}})}}},{key:"boundedCoords",value:function(e,t,n,r){var o=e-n,i=t-r,a=this.state.image.width*this.state.zoom,s=(a-this.state.image.width)/2,u=(this.state.image.x,this.props.width);e=o-s>0?s:o<-a+u?u-a:o;var p=this.state.image.height*this.state.zoom,d=(p-this.state.image.height)/2,h=(this.state.image.y,this.props.height);return{x:e,y:t=i-d>0?d:i<-p+h?h-p:i}}},{key:"componentDidMount",value:function(){var e=this,t=s.default.findDOMNode(this.refs.canvas);t.getContext("2d");this.prepareImage(this.props.image),this.listeners={mousemove:function(t){return e.mouseMoveListener(t)},mouseup:function(t){return e.mouseUpListener(t)},mousedown:function(t){return e.mouseDownListener(t)}},window.addEventListener("mousemove",this.listeners.mousemove,!1),window.addEventListener("mouseup",this.listeners.mouseup,!1),t.addEventListener("mousedown",this.listeners.mousedown,!1),window.addEventListener("touchmove",this.listeners.mousemove,!1),window.addEventListener("touchend",this.listeners.mouseup,!1),t.addEventListener("touchstart",this.listeners.mousedown,!1),document.onselectstart=function(t){return e.preventSelection(t)}}},{key:"componentWillUnmount",value:function(){var e=s.default.findDOMNode(this.refs.canvas);window.removeEventListener("mousemove",this.listeners.mousemove),window.removeEventListener("mouseup",this.listeners.mouseup),e.removeEventListener("mousedown",this.listeners.mousedown),window.removeEventListener("touchmove",this.listeners.mousemove,!1),window.removeEventListener("touchend",this.listeners.mouseup,!1),e.removeEventListener("touchstart",this.listeners.mousedown,!1)}},{key:"componentDidUpdate",value:function(){var e=s.default.findDOMNode(this.refs.canvas).getContext("2d");e.clearRect(0,0,this.props.width,this.props.height),this.addImageToCanvas(e,this.state.image)}},{key:"addImageToCanvasWithOriginalSize",value:function(e,t,n,r){if(r.resource){var o=this.state.zoom,i=r.resource;e.save(),e.globalCompositeOperation="destination-over";var a=void 0,s=void 0;if(n/t>i.height/i.width){a=n;var u=n/i.height;s=i.width*u}else{s=t;var p=t/i.width;a=i.height*p}var d=s*o,h=a*o,c=t/this.props.width,l=n/this.props.height,f=r.x*c-(d-s)/2,m=r.y*l-(h-a)/2;f=Math.min(f,0),m=h+(m=Math.min(m,0))>=n?m:m+(n-(h+m)),f=d+f>=t?f:f+(t-(d+f)),e.drawImage(i,f,m,s*o,a*o),e.restore()}}},{key:"getOriginalCroppedImage",value:function(){var e=this.state.image,t=document.createElement("canvas"),n=t.getContext("2d"),r=this.props.height,o=this.props.width/r,i=void 0,a=void 0;return e.resource.width>e.resource.height?i=(a=e.resource.height)*o:a=(i=e.resource.width)/o,t.width=i/this.state.zoom,t.height=a/this.state.zoom,this.addImageToCanvasWithOriginalSize(n,t.width,t.height,e),t.toDataURL("image/jpeg",.9)}},{key:"addImageToCanvas",value:function(e,t){if(t.resource){e.save(),e.globalCompositeOperation="destination-over";var n=this.state.image.width*this.state.zoom,r=this.state.image.height*this.state.zoom,o=t.x-(n-this.state.image.width)/2,i=t.y-(r-this.state.image.height)/2;o=Math.min(o,0),i=r+(i=Math.min(i,0))>=this.props.height?i:i+(this.props.height-(r+i)),o=n+o>=this.props.width?o:o+(this.props.width-(n+o)),e.drawImage(t.resource,o,i,t.width*this.state.zoom,t.height*this.state.zoom),e.restore()}}},{key:"toDataURL",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=this.props.width,e.height=this.props.height,this.addImageToCanvas(t,{resource:this.state.image.resource,x:this.state.image.x,y:this.state.image.y,height:this.state.image.height,width:this.state.image.width}),e.toDataURL()}},{key:"handleCrop",value:function(){this.state.image;var e=this.props,t=e.isOriginalSize;(0,e.onCrop)(t?this.getOriginalCroppedImage():this.toDataURL())}},{key:"handleZoomUpdate",value:function(){var e=this.state;e.zoom=s.default.findDOMNode(this.refs.zoom).value,this.setState({newstate:e})}},{key:"render",value:function(){return a.default.createElement("div",{className:"AvatarCropper-canvas"},a.default.createElement("div",{className:"row"},a.default.createElement("canvas",{ref:"canvas",width:this.props.width,height:this.props.height})),a.default.createElement("div",{className:"row"},a.default.createElement("input",{type:"range",name:"zoom",ref:"zoom",onChange:this.handleZoomUpdate.bind(this),style:{width:this.props.width},min:"1",max:"3",step:"0.01",defaultValue:"1"})),a.default.createElement("div",{className:"modal-footer"},a.default.createElement(p.Button,{onClick:this.props.onRequestHide},this.props.closeButtonCopy),a.default.createElement(p.Button,{primary:!0,onClick:this.handleCrop.bind(this)},this.props.cropButtonCopy)))}}]),t}();g.propTypes={image:u.default.string.isRequired,width:v,height:v,zoom:v,isOriginalSize:u.default.bool},g.defaultProps={width:400,height:400,zoom:1,isOriginalSize:!0};var y=function(e){function t(){return l(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return m(t,a.default.Component),o(t,[{key:"handleZoomUpdate",value:function(){var e=s.default.findDOMNode(this.refs.zoom).value;this.setState({zoom:e})}},{key:"render",value:function(){var e=this.props.modalOptions,t=e.header,n=(e.content,function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["header","content"]));return a.default.createElement(p.Modal,r({onClose:this.props.onRequestHide,open:this.props.cropperOpen},n),t&&a.default.createElement(p.Modal.Header,null,t),a.default.createElement("div",{className:"modal-body"},a.default.createElement("div",{className:"AvatarCropper-base"},a.default.createElement(g,{image:this.props.image,width:this.props.width,height:this.props.height,onCrop:this.props.onCrop,onRequestHide:this.props.onRequestHide,closeButtonCopy:this.props.closeButtonCopy,cropButtonCopy:this.props.cropButtonCopy}))))}}]),t}();y.propTypes={image:u.default.string.isRequired,onCrop:u.default.func.isRequired,closeButtonCopy:u.default.string,cropButtonCopy:u.default.string,width:v,height:v,onRequestHide:u.default.func.isRequired,modalOptions:u.default.object},y.defaultProps={width:400,height:400,closeButtonCopy:"Close",cropButtonCopy:"Crop and Save",modalOptions:{}},t.default=y},function(e,t,n){e.exports=n(12)}])});